import{n as I,_ as j,z as N,D as E,c as G,E as R,o as Z}from"../app.377bd381.js";var A={exports:{}};(function(d,y){(function(v,C){d.exports=C()})(I,function(){var v=typeof window!="undefined"?window:typeof I!="undefined"?I:this;function C(r,s){return s={exports:{}},r(s,s.exports,v),s.exports}var m=C(function(r,s,u){(function(l,e){typeof s=="object"?r.exports=e():(l.BMapLib=l.BMapLib||{},l.BMapLib.TextIconOverlay=l.BMapLib.TextIconOverlay||e())})(v,function(){var l,e=l=e||{version:"1.3.8"},c={};e.guid="$BAIDU$",c[e.guid]=c[e.guid]||{},e.dom=e.dom||{},e.dom.g=function(t){return typeof t=="string"||t instanceof String?document.getElementById(t):t&&t.nodeName&&(t.nodeType==1||t.nodeType==9)?t:null},e.g=e.G=e.dom.g,e.dom.getDocument=function(t){return t=e.dom.g(t),t.nodeType==9?t:t.ownerDocument||t.document},e.lang=e.lang||{},e.lang.isString=function(t){return Object.prototype.toString.call(t)=="[object String]"},e.isString=e.lang.isString,e.dom._g=function(t){return e.lang.isString(t)?document.getElementById(t):t},e._g=e.dom._g,e.browser=e.browser||{},/msie (\d+\.\d)/i.test(navigator.userAgent)&&(e.browser.ie=e.ie=document.documentMode||+RegExp.$1),e.dom.getComputedStyle=function(t,i){t=e.dom._g(t);var n=e.dom.getDocument(t),a;return n.defaultView&&n.defaultView.getComputedStyle&&(a=n.defaultView.getComputedStyle(t,null),a)?a[i]||a.getPropertyValue(i):""},e.dom._styleFixer=e.dom._styleFixer||{},e.dom._styleFilter=e.dom._styleFilter||[],e.dom._styleFilter.filter=function(t,i,n){for(var a=0,o=e.dom._styleFilter,f;f=o[a];a++)(f=f[n])&&(i=f(t,i));return i},e.string=e.string||{},e.string.toCamelCase=function(t){return t.indexOf("-")<0&&t.indexOf("_")<0?t:t.replace(/[-_][^-_]/g,function(i){return i.charAt(1).toUpperCase()})},e.dom.getStyle=function(t,i){var n=e.dom;t=n.g(t),i=e.string.toCamelCase(i);var a=t.style[i]||(t.currentStyle?t.currentStyle[i]:"")||n.getComputedStyle(t,i);if(!a){var o=n._styleFixer[i];o&&(a=o.get?o.get(t):e.dom.getStyle(t,o))}return(o=n._styleFilter)&&(a=o.filter(i,a,"get")),a},e.getStyle=e.dom.getStyle,/opera\/(\d+\.\d)/i.test(navigator.userAgent)&&(e.browser.opera=+RegExp.$1),e.browser.isWebkit=/webkit/i.test(navigator.userAgent),e.browser.isGecko=/gecko/i.test(navigator.userAgent)&&!/like gecko/i.test(navigator.userAgent),e.browser.isStrict=document.compatMode=="CSS1Compat",e.dom.getPosition=function(t){t=e.dom.g(t);var i=e.dom.getDocument(t),n=e.browser,a=e.dom.getStyle;n.isGecko>0&&i.getBoxObjectFor&&a(t,"position")=="absolute"&&(t.style.top===""||t.style.left);var o={left:0,top:0},f=n.ie&&!n.isStrict?i.body:i.documentElement,h,_;if(t==f)return o;if(t.getBoundingClientRect){_=t.getBoundingClientRect(),o.left=Math.floor(_.left)+Math.max(i.documentElement.scrollLeft,i.body.scrollLeft),o.top=Math.floor(_.top)+Math.max(i.documentElement.scrollTop,i.body.scrollTop),o.left-=i.documentElement.clientLeft,o.top-=i.documentElement.clientTop;var M=i.body,b=parseInt(a(M,"borderLeftWidth")),L=parseInt(a(M,"borderTopWidth"));n.ie&&!n.isStrict&&(o.left-=isNaN(b)?2:b,o.top-=isNaN(L)?2:L)}else{h=t;do{if(o.left+=h.offsetLeft,o.top+=h.offsetTop,n.isWebkit>0&&a(h,"position")=="fixed"){o.left+=i.body.scrollLeft,o.top+=i.body.scrollTop;break}h=h.offsetParent}while(h&&h!=t);for((n.opera>0||n.isWebkit>0&&a(t,"position")=="absolute")&&(o.top-=i.body.offsetTop),h=t.offsetParent;h&&h!=i.body;)o.left-=h.scrollLeft,(!n.opera||h.tagName!="TR")&&(o.top-=h.scrollTop),h=h.offsetParent}return o},e.event=e.event||{},e.event._listeners=e.event._listeners||[],e.event.on=function(t,i,n){i=i.replace(/^on/i,""),t=e.dom._g(t);var a=function(M){n.call(t,M)},o=e.event._listeners,f=e.event._eventFilter,h,_=i;return i=i.toLowerCase(),f&&f[i]&&(h=f[i](t,i,a),_=h.type,a=h.listener),t.addEventListener?t.addEventListener(_,a,!1):t.attachEvent&&t.attachEvent("on"+_,a),o[o.length]=[t,i,n,a,_],t},e.on=e.event.on,function(){var t=c[e.guid];e.lang.guid=function(){return"TANGRAM__"+(t._counter++).toString(36)},t._counter=t._counter||1}(),c[e.guid]._instances=c[e.guid]._instances||{},e.lang.isFunction=function(t){return Object.prototype.toString.call(t)=="[object Function]"},e.lang.Class=function(t){this.guid=t||e.lang.guid(),c[e.guid]._instances[this.guid]=this},c[e.guid]._instances=c[e.guid]._instances||{},e.lang.Class.prototype.dispose=function(){delete c[e.guid]._instances[this.guid];for(var t in this)e.lang.isFunction(this[t])||delete this[t];this.disposed=!0},e.lang.Class.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"},e.lang.Event=function(t,i){this.type=t,this.returnValue=!0,this.target=i||null,this.currentTarget=null},e.lang.Class.prototype.addEventListener=function(t,i,n){if(!!e.lang.isFunction(i)){!this.__listeners&&(this.__listeners={});var a=this.__listeners,o;if(typeof n=="string"&&n){if(/[^\w\-]/.test(n))throw"nonstandard key:"+n;i.hashCode=n,o=n}t.indexOf("on")!=0&&(t="on"+t),typeof a[t]!="object"&&(a[t]={}),o=o||e.lang.guid(),i.hashCode=o,a[t][o]=i}},e.lang.Class.prototype.removeEventListener=function(t,i){if(!(typeof i!="undefined"&&(e.lang.isFunction(i)&&!(i=i.hashCode)||!e.lang.isString(i)))){!this.__listeners&&(this.__listeners={}),t.indexOf("on")!=0&&(t="on"+t);var n=this.__listeners;if(!!n[t])if(typeof i!="undefined")n[t][i]&&delete n[t][i];else for(var a in n[t])delete n[t][a]}},e.lang.Class.prototype.dispatchEvent=function(t,i){e.lang.isString(t)&&(t=new e.lang.Event(t)),!this.__listeners&&(this.__listeners={}),i=i||{};for(var n in i)t[n]=i[n];var n,a=this.__listeners,o=t.type;if(t.target=t.target||this,t.currentTarget=this,o.indexOf("on")!=0&&(o="on"+o),e.lang.isFunction(this[o])&&this[o].apply(this,arguments),typeof a[o]=="object")for(n in a[o])a[o][n].apply(this,arguments);return t.returnValue},e.lang.inherits=function(t,i,n){var a,o,f=t.prototype,h=new Function;h.prototype=i.prototype,o=t.prototype=new h;for(a in f)o[a]=f[a];t.prototype.constructor=t,t.superClass=i.prototype,typeof n=="string"&&(o._className=n)},e.inherits=e.lang.inherits;var k="http://api.map.baidu.com/library/TextIconOverlay/1.2/src/images/m",F="png",g=function(t,i,n){try{BMap}catch{throw Error("Baidu Map JS API is not ready yet!")}l.lang.inherits(g,BMap.Overlay,"TextIconOverlay"),this._position=t,this._text=i,this._options=n||{},this._styles=this._options.styles||[],!this._styles.length&&this._setupDefaultStyles()};return g.prototype._setupDefaultStyles=function(){for(var t=[53,56,66,78,90],i=0,n;n=t[i];i++)this._styles.push({url:k+i+"."+F,size:new BMap.Size(n,n)})},g.prototype.initialize=function(t){return this._map=t,this._domElement=document.createElement("div"),this._updateCss(),this._updateText(),this._updatePosition(),this._bind(),this._map.getPanes().markerMouseTarget.appendChild(this._domElement),this._domElement},g.prototype.draw=function(){this._map&&this._updatePosition()},g.prototype.getText=function(){return this._text},g.prototype.setText=function(t){t&&(!this._text||this._text.toString()!=t.toString())&&(this._text=t,this._updateText(),this._updateCss(),this._updatePosition())},g.prototype.getPosition=function(){return this._position},g.prototype.setPosition=function(t){t&&(!this._position||!this._position.equals(t))&&(this._position=t,this._updatePosition())},g.prototype.getStyleByText=function(t,i){var n=parseInt(t),a=parseInt(n/10);return a=Math.max(0,a),a=Math.min(a,i.length-1),i[a]},g.prototype._updateCss=function(){if(!!this._domElement){var t=this.getStyleByText(this._text,this._styles);this._domElement.style.cssText=this._buildCssText(t)}},g.prototype._updateText=function(){this._domElement&&(this._domElement.innerHTML=this._text)},g.prototype._updatePosition=function(){if(this._domElement&&this._position){var t=this._domElement.style,i=this._map.pointToOverlayPixel(this._position);i.x-=Math.ceil(parseInt(t.width)/2),i.y-=Math.ceil(parseInt(t.height)/2),t.left=i.x+"px",t.top=i.y+"px"}},g.prototype._buildCssText=function(t){var i=t.url,n=t.size,a=t.anchor,o=t.offset,f=t.textColor||"black",h=t.textSize||10,_=[];if(l.browser.ie<7)_.push('filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src="'+i+'");');else{_.push("background-image:url("+i+");");var M="0 0";o instanceof BMap.Size&&(M=o.width+"px "+o.height+"px"),_.push("background-position:"+M+";")}return n instanceof BMap.Size&&(a instanceof BMap.Size?(a.height>0&&a.height<n.height&&_.push("height:"+(n.height-a.height)+"px; padding-top:"+a.height+"px;"),a.width>0&&a.width<n.width&&_.push("width:"+(n.width-a.width)+"px; padding-left:"+a.width+"px;")):(_.push("height:"+n.height+"px; line-height:"+n.height+"px;"),_.push("width:"+n.width+"px; text-align:center;"))),_.push("cursor:pointer; color:"+f+"; position:absolute; font-size:"+h+"px; font-family:Arial,sans-serif; font-weight:bold"),_.join("")},g.prototype._bind=function(){if(!this._domElement)return;var t=this,i=this._map,n=l.lang.Event;function a(o,f){var h=o.srcElement||o.target,_=o.clientX||o.pageX,M=o.clientY||o.pageY;if(o&&f&&_&&M&&h){var b=l.dom.getPosition(i.getContainer());f.pixel=new BMap.Pixel(_-b.left,M-b.top),f.point=i.pixelToPoint(f.pixel)}return f}l.event.on(this._domElement,"mouseover",function(o){t.dispatchEvent(a(o,new n("onmouseover")))}),l.event.on(this._domElement,"mouseout",function(o){t.dispatchEvent(a(o,new n("onmouseout")))}),l.event.on(this._domElement,"click",function(o){t.dispatchEvent(a(o,new n("onclick")))})},g})}),B=m&&typeof m=="object"&&"default"in m?m.default:m,T=function(r,s,u){s=w(s);var l=r.pointToPixel(s.getNorthEast()),e=r.pointToPixel(s.getSouthWest());l.x+=u,l.y-=u,e.x-=u,e.y+=u;var c=r.pixelToPoint(l),k=r.pixelToPoint(e);return new BMap.Bounds(k,c)},w=function(r){var s=S(r.getNorthEast().lng,-180,180),u=S(r.getSouthWest().lng,-180,180),l=S(r.getNorthEast().lat,-74,74),e=S(r.getSouthWest().lat,-74,74);return new BMap.Bounds(new BMap.Point(u,e),new BMap.Point(s,l))},S=function(r,s,u){return s&&(r=Math.max(r,s)),u&&(r=Math.min(r,u)),r},O=function(r){return Object.prototype.toString.call(r)==="[object Array]"},P=function(r,s){var u=-1;if(O(s)){if(s.indexOf)u=s.indexOf(r);else for(var l=0,e;e=s[l];l++)if(e===r){u=l;break}}return u},p=function(r,s){try{BMap}catch{throw Error("Baidu Map JS API is not ready yet!")}if(!!r){this._map=r,this._markers=[],this._clusters=[];var u=s||{};this._gridSize=u.gridSize||60,this._maxZoom=u.maxZoom||18,this._minClusterSize=u.minClusterSize||2,this._isAverageCenter=!1,u.isAverageCenter!=null&&(this._isAverageCenter=u.isAverageCenter),this._styles=u.styles||[];var l=this;this._map.addEventListener("zoomend",function(){l._redraw()}),this._map.addEventListener("moveend",function(){l._redraw()});var e=u.markers;O(e)&&this.addMarkers(e)}};p.prototype.addMarkers=function(r){if(!!r.length){for(var s=0,u=r.length;s<u;s++)this._pushMarkerTo(r[s]);this._createClusters()}},p.prototype._pushMarkerTo=function(r){var s=P(r,this._markers);s===-1&&(r.isInCluster=!1,this._markers.push(r))},p.prototype.addMarker=function(r){this._pushMarkerTo(r),this._createClusters()},p.prototype._createClusters=function(){var r=this._map.getBounds();if(!!r.getCenter())for(var s=T(this._map,r,this._gridSize),u=0,l;l=this._markers[u];u++)!l.isInCluster&&s.containsPoint(l.getPosition())&&this._addToClosestCluster(l)},p.prototype._addToClosestCluster=function(r){var s=4e6,u=null;r.getPosition();for(var l=0,e;e=this._clusters[l];l++){var c=e.getCenter();if(c){var k=this._map.getDistance(c,r.getPosition());k<s&&(s=k,u=e)}}if(u&&u.isMarkerInClusterBounds(r))u.addMarker(r);else{var e=new x(this);e.addMarker(r),this._clusters.push(e)}},p.prototype._clearLastClusters=function(){for(var r=0,s;s=this._clusters[r];r++)s.remove();this._clusters=[],this._removeMarkersFromCluster()},p.prototype._removeMarkersFromCluster=function(){for(var r=0,s;s=this._markers[r];r++)s.isInCluster=!1},p.prototype._removeMarkersFromMap=function(){for(var r=0,s;s=this._markers[r];r++){s.isInCluster=!1;var u=s.getLabel();this._map.removeOverlay(s),s.setLabel(u)}},p.prototype._removeMarker=function(r){var s=P(r,this._markers);return s===-1?!1:(this._map.removeOverlay(r),this._markers.splice(s,1),!0)},p.prototype.removeMarker=function(r){var s=this._removeMarker(r);return s&&(this._clearLastClusters(),this._createClusters()),s},p.prototype.removeMarkers=function(r){for(var s=!1,u=0;u<r.length;u++){var l=this._removeMarker(r[u]);s=s||l}return s&&(this._clearLastClusters(),this._createClusters()),s},p.prototype.clearMarkers=function(){this._clearLastClusters(),this._removeMarkersFromMap(),this._markers=[]},p.prototype._redraw=function(){this._clearLastClusters(),this._createClusters()},p.prototype.getGridSize=function(){return this._gridSize},p.prototype.setGridSize=function(r){this._gridSize=r,this._redraw()},p.prototype.getMaxZoom=function(){return this._maxZoom},p.prototype.setMaxZoom=function(r){this._maxZoom=r,this._redraw()},p.prototype.getStyles=function(){return this._styles},p.prototype.setStyles=function(r){this._styles=r,this._redraw()},p.prototype.getMinClusterSize=function(){return this._minClusterSize},p.prototype.setMinClusterSize=function(r){this._minClusterSize=r,this._redraw()},p.prototype.isAverageCenter=function(){return this._isAverageCenter},p.prototype.getMap=function(){return this._map},p.prototype.getMarkers=function(){return this._markers},p.prototype.getClustersCount=function(){for(var r=0,s=0,u;u=this._clusters[s];s++)u.isReal()&&r++;return r};function x(r){this._markerClusterer=r,this._map=r.getMap(),this._minClusterSize=r.getMinClusterSize(),this._isAverageCenter=r.isAverageCenter(),this._center=null,this._markers=[],this._gridBounds=null,this._isReal=!1,this._clusterMarker=new B(this._center,this._markers.length,{styles:this._markerClusterer.getStyles()})}return x.prototype.addMarker=function(r){if(this.isMarkerInCluster(r))return!1;if(!this._center)this._center=r.getPosition(),this.updateGridBounds();else if(this._isAverageCenter){var s=this._markers.length+1,u=(this._center.lat*(s-1)+r.getPosition().lat)/s,l=(this._center.lng*(s-1)+r.getPosition().lng)/s;this._center=new BMap.Point(l,u),this.updateGridBounds()}r.isInCluster=!0,this._markers.push(r);var e=this._markers.length;if(e<this._minClusterSize)return this._map.addOverlay(r),!0;if(e===this._minClusterSize)for(var c=0;c<e;c++){var k=this._markers[c].getLabel();this._markers[c].getMap()&&this._map.removeOverlay(this._markers[c]),this._markers[c].setLabel(k)}return this._map.addOverlay(this._clusterMarker),this._isReal=!0,this.updateClusterMarker(),!0},x.prototype.isMarkerInCluster=function(r){if(this._markers.indexOf)return this._markers.indexOf(r)!=-1;for(var s=0,u;u=this._markers[s];s++)if(u===r)return!0;return!1},x.prototype.isMarkerInClusterBounds=function(r){return this._gridBounds.containsPoint(r.getPosition())},x.prototype.isReal=function(r){return this._isReal},x.prototype.updateGridBounds=function(){var r=new BMap.Bounds(this._center,this._center);this._gridBounds=T(this._map,r,this._markerClusterer.getGridSize())},x.prototype.updateClusterMarker=function(){if(this._map.getZoom()>this._markerClusterer.getMaxZoom()){this._clusterMarker&&this._map.removeOverlay(this._clusterMarker);for(var r=0,s;s=this._markers[r];r++)this._map.addOverlay(s);return}if(this._markers.length<this._minClusterSize){this._clusterMarker.hide();return}this._clusterMarker.setPosition(this._center),this._clusterMarker.setText(this._markers.length),this._clusterMarker.addEventListener&&!this._clusterMarker._hasClickEvent&&this._clusterMarker.addEventListener("click",function(u){this._clusterMarker._hasClickEvent=!0,this._markers&&this._map.setViewport(this.getBounds())}.bind(this))},x.prototype.remove=function(){for(var r=0;this._markers[r];r++){var s=this._markers[r].getLabel();this._markers[r].getMap()&&this._map.removeOverlay(this._markers[r]),this._markers[r].setLabel(s)}this._map.removeOverlay(this._clusterMarker),this._markers.length=0,delete this._markers},x.prototype.getBounds=function(){for(var r=new BMap.Bounds(this._center,this._center),s=0,u;u=this._markers[s];s++)r.extend(u.getPosition());return r},x.prototype.getCenter=function(){return this._center},p})})(A);var $=A.exports;const z=[],D={name:"bml-marker-clusterer",mixins:[N("markerClusterer")],provide(){return{Cluster:this}},props:{gridSize:{type:Object},maxZoom:{type:Number},minClusterSize:{type:Number},styles:{type:Array,default(){return[]}},averageCenter:{type:Boolean,default:!1}},data(){return{}},watch:{gridSize:{handler(d){const{BMap:y,originInstance:v}=this;v.setGridSize(y,d.map)},deep:!0},maxZoom(d){const{originInstance:y}=this;y.setMaxZoom(d)},minClusterSize:{handler(d){const{BMap:y,originInstance:v}=this;v.setMinClusterSize(E(y,d))},deep:!0},styles:{handler(d){const{BMap:y,originInstance:v}=this,C=JSON.parse(JSON.stringify(d)).map(m=>(m.size=m.size&&E(y,m.size),m));v.setStyles(C)},deep:!0},averageCenter(d){this.reload()}},methods:{load(){const{BMap:d,map:y,gridSize:v,minClusterSize:C,maxZoom:m,styles:B,averageCenter:T}=this;this.originInstance=new $(y,{gridSize:v&&E(d,v),maxZoom:m,minClusterSize:C&&E(d,C),styles:B.map(w=>(w.size=E(d,w.size),w)),isAverageCenter:T}),this.$nextTick(()=>{const w=z.map(S=>S.originInstance).filter(S=>S instanceof d.Marker);this.originInstance.addMarkers(w)})},addMaker(d){z.push(d)},removeMaker(d){z.splice(z.indexOf(d),1)}},beforeCreate(){this.preventChildrenRender=!0}};function W(d,y,v,C,m,B){return Z(),G("span",null,[R(d.$slots,"default")])}var X=j(D,[["render",W]]);export{X as default};
